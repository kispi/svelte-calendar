
> svelte-calendar@0.0.1 check
> svelte-kit sync && svelte-check --tsconfig ./tsconfig.json

Loading svelte-check in workspace: c:\dev\svelte-calendar
Getting Svelte diagnostics...

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:65:14
[31mError[39m: ';' expected. 
[36m    model: 'gemini-2.0-flash-exp',
        tools[35m:[36m [
            {[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:105:30
[31mError[39m: ';' expected. 
[36m        ],
            systemInstruction[35m:[36m {
        role: 'system',[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:107:18
[31mError[39m: ';' expected. 
[36m        role: 'system',
            parts[35m:[36m [{
                text: `You are Justodo Assistant, a helpful AI built into the Justodo Planner.[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:126:2
[31mError[39m: ',' expected. 
[36m    }
}[35m)[36m[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:193:1
[31mError[39m: Declaration or statement expected. 
[36m})
[35m}[36m[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:15:14
[31mError[39m: Type '({ request, locals }: RequestEvent<RouteParams, "/api/chat">) => Promise<void>' is not assignable to type 'RequestHandler'.
  Type 'Promise<void>' is not assignable to type 'MaybePromise<Response>'.
    Type 'Promise<void>' is not assignable to type 'Promise<Response>'.
      Type 'void' is not assignable to type 'Response'. 
[36m
export const [35mPOST[36m: RequestHandler = async ({ request, locals }) => {
    const session = await locals.auth()[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:64:12
[31mError[39m: Left side of comma operator is unused and has no side effects. 
[36m
    model: [35m'gemini-2.0-flash-exp'[36m,
        tools: [[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:65:16
[31mError[39m: Left side of comma operator is unused and has no side effects. 
[36m    model: 'gemini-2.0-flash-exp',
        tools: [35m[
            {
                functionDeclarations: [
                    {
                        name: 'get_events',
                        description:
                            'Get all calendar events. Use this to find events.',
                        parameters: {
                            type: SchemaType.OBJECT,
                            properties: {
                                startDate: {
                                    type: SchemaType.STRING,
                                    description: 'Start date (ISO8601)'
                                },
                                endDate: {
                                    type: SchemaType.STRING,
                                    description: 'End date (ISO8601)'
                                }
                            },
                            required: ['startDate', 'endDate']
                        }
                    },
                    {
                        name: 'move_to_date',
                        description:
                            'Move the calendar view to a specific date. Use this when the user asks to "go to" or "show" a date.',
                        parameters: {
                            type: SchemaType.OBJECT,
                            properties: {
                                date: {
                                    type: SchemaType.STRING,
                                    description: 'Target date (ISO8601)'
                                }
                            },
                            required: ['date']
                        }
                    }
                ]
            } as any
        ][36m,
            systemInstruction: {[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:105:13
[31mError[39m: Cannot find name 'systemInstruction'. 
[36m        ],
            [35msystemInstruction[36m: {
        role: 'system',[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:106:15
[31mError[39m: Left side of comma operator is unused and has no side effects. 
[36m            systemInstruction: {
        role: [35m'system'[36m,
            parts: [{[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:107:13
[31mError[39m: Cannot find name 'parts'. 
[36m        role: 'system',
            [35mparts[36m: [{
                text: `You are Justodo Assistant, a helpful AI built into the Justodo Planner.[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:128:21
[31mError[39m: Cannot find name 'messages'. Did you mean 'onmessage'? 
[36m
const lastMessage = [35mmessages[36m[messages.length - 1]
// lastMessage should be { role: 'user', parts: [{ text: '...' }] }[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:128:30
[31mError[39m: Cannot find name 'messages'. Did you mean 'onmessage'? 
[36m
const lastMessage = messages[[35mmessages[36m.length - 1]
// lastMessage should be { role: 'user', parts: [{ text: '...' }] }[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:130:22
[31mError[39m: Cannot find name 'chat'. 
[36m// lastMessage should be { role: 'user', parts: [{ text: '...' }] }
const result = await [35mchat[36m.sendMessage(lastMessage.parts)
let response = result.response[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:135:55
[31mError[39m: Parameter 'p' implicitly has an 'any' type. 
[36mlet callCount = 0
while (response.candidates?.[0]?.content?.parts?.some([35mp[36m => p.functionCall) && callCount < 5) {
    callCount++[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:150:51
[31mError[39m: Cannot find name 'userId'. 
[36m                        and(
                            eq(eventTable.userId, [35muserId[36m),
                            gte(eventTable.startTime, dayjs(startDate).startOf('day').toISOString()),[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:176:34
[31mError[39m: Cannot find name 'chat'. 
[36m    if (toolResponses.length > 0) {
        const toolResult = await [35mchat[36m.sendMessage(toolResponses)
        response = toolResult.response[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:182:27
[31mError[39m: Cannot find name 'chat'. 
[36m// Capture the full updated history from the chat session
const fullHistory = await [35mchat[36m.getHistory()[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:185:38
[31mError[39m: Parameter 'h' implicitly has an 'any' type. 
[36m// Check if move_to_date was called in the chain to signal the UI
const allParts = fullHistory.flatMap([35mh[36m => h.parts)
const moveCall = allParts.find(p => p.functionCall?.name === 'move_to_date')[39m

c:\dev\svelte-calendar\[32msrc\routes\api\chat\+server.ts[39m:186:32
[31mError[39m: Parameter 'p' implicitly has an 'any' type. 
[36mconst allParts = fullHistory.flatMap(h => h.parts)
const moveCall = allParts.find([35mp[36m => p.functionCall?.name === 'move_to_date')[39m

====================================
[31msvelte-check found 20 errors and 0 warnings in 1 file
[39m
